<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Admin — Suivi réparations</title>
  <link rel="stylesheet" href="/admin/style.css"/>
</head>
<body>
<div class="container">
  <h1>Admin — Suivi réparations</h1>
  <p class="muted small">Donne un code au client. Il suit l’état ici : <a href="/suivi.html">/suivi.html</a>.</p>

  <div class="card grid g2">
    <div>
      <label>Clé admin (une fois pour toutes)</label>
      <input id="adm_token" placeholder="ADMIN_TOKEN"/>
      <button class="btn out" id="btnSaveToken">Enregistrer</button>
    </div>
    <div>
      <label>Charger un ticket par code</label>
      <div class="grid g2">
        <input id="load_code" placeholder="DRP-2025-123"/>
        <div class="toolbar">
          <button class="btn" id="btnLoad">Charger</button>
          <button class="btn out" id="btnOpen">Tous (ouverts)</button>
          <button class="btn out" id="btnLast">Derniers (100)</button>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="grid g2" style="align-items:end">
      <div>
        <label>Recherche (code, nom, modèle, statut)</label>
        <input id="q" placeholder="Ex: Martin, iPhone 13, DRP-2025..."/>
      </div>
      <div class="toolbar">
        <label style="display:flex;align-items:center;gap:6px"><input type="checkbox" id="onlyOpen" checked/> Uniquement ouverts</label>
        <button class="btn" id="btnSearch">Rechercher</button>
      </div>
    </div>
    <div id="results" class="small muted" style="margin-top:8px"></div>
  </div>

  <div class="card">
    <div class="grid g2">
      <div>
        <label>Code (laisser vide pour auto)</label>
        <input id="f_code" placeholder="DRP-2025-123"/>
      </div>
      <div>
        <label>Statut</label>
        <select id="f_status">
          <option>Réceptionné</option>
          <option>Diagnostique</option>
          <option>En cours</option>
          <option>En attente</option>
          <option>Terminé</option>
          <option>Livré</option>
        </select>
      </div>
      <div>
        <label>Modèle</label>
        <input id="f_model" placeholder="iPhone 13"/>
      </div>
      <div>
        <label>Client</label>
        <input id="f_client" placeholder="Nom / Initiales (ex. L. Martin)"/>
      </div>
    </div>
    <label>Note</label>
    <textarea id="f_note" placeholder="Détails utiles..."></textarea>
    <div class="toolbar" style="margin-top:8px">
      <button class="btn" id="btnSave">Enregistrer / Mettre à jour</button>
      <button class="btn out" id="btnNewCode">Nouveau code (garde le client)</button>
      <button class="btn out" id="btnLink">Lien suivi client</button>
      <button class="btn out" id="btnPrint">Imprimer la fiche</button>
      <span class="small muted right" id="msg"></span>
    </div>
  </div>

  <div class="footer small muted">Stockage Netlify Blobs (`tickets`/`all`).</div>
</div>

<script src="/admin/suivi.js"></script>
</body>
</html>
